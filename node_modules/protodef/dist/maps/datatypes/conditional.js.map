{"version":3,"sources":["datatypes/conditional.js"],"names":[],"mappings":"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","file":"datatypes/conditional.js","sourcesContent":["var { getField, getFieldInfo, tryDoc} = require('../utils');\n\nmodule.exports = {\n  'switch': [readSwitch, writeSwitch, sizeOfSwitch],\n  'option': [readOption, writeOption, sizeOfOption]\n};\n\nfunction readSwitch(buffer, offset, {compareTo,fields,...rest}, rootNode) {\n  compareTo = getField(compareTo, rootNode);\n  if (typeof fields[compareTo] === 'undefined' && typeof rest.default === \"undefined\")\n    throw new Error(compareTo + \" has no associated fieldInfo in switch\");\n\n  var caseDefault=typeof fields[compareTo] === 'undefined';\n  var resultingType = caseDefault ? rest.default : fields[compareTo];\n  var fieldInfo = getFieldInfo(resultingType);\n  return tryDoc(() => this.read(buffer, offset, fieldInfo, rootNode),caseDefault ? \"default\" : compareTo);\n}\n\nfunction writeSwitch(value, buffer, offset, {compareTo,fields,...rest}, rootNode) {\n  compareTo = getField(compareTo, rootNode);\n  if (typeof fields[compareTo] === 'undefined' && typeof rest.default === \"undefined\")\n    throw new Error(compareTo + \" has no associated fieldInfo in switch\");\n\n  var caseDefault=typeof fields[compareTo] === 'undefined';\n  var fieldInfo = getFieldInfo(caseDefault ? rest.default : fields[compareTo]);\n  return tryDoc(() => this.write(value, buffer, offset, fieldInfo, rootNode),caseDefault ? \"default\" : compareTo);\n}\n\nfunction sizeOfSwitch(value, {compareTo,fields,...rest}, rootNode) {\n  compareTo = getField(compareTo, rootNode);\n  if (typeof fields[compareTo] === 'undefined' && typeof rest.default === \"undefined\")\n    throw new Error(compareTo + \" has no associated fieldInfo in switch\");\n\n  var caseDefault=typeof fields[compareTo] === 'undefined';\n  var fieldInfo = getFieldInfo(caseDefault ? rest.default : fields[compareTo]);\n  return tryDoc(() => this.sizeOf(value, fieldInfo, rootNode),caseDefault ? \"default\" : compareTo);\n}\n\nfunction readOption(buffer, offset, typeArgs, context) {\n  var val = buffer.readUInt8(offset++);\n  if (val !== 0) {\n    var retval = this.read(buffer, offset, typeArgs, context);\n    retval.size++;\n    return retval;\n  }\n  else\n    return {size: 1};\n}\n\nfunction writeOption(value, buffer, offset, typeArgs, context) {\n  if (value != null) {\n    buffer.writeUInt8(1, offset++);\n    offset=this.write(value, buffer, offset, typeArgs, context);\n  }\n  else\n    buffer.writeUInt8(0, offset++);\n  return offset;\n}\n\nfunction sizeOfOption(value, typeArgs, context) {\n  return value == null ? 1 : this.sizeOf(value, typeArgs, context) + 1;\n}\n"],"sourceRoot":"/source/"}